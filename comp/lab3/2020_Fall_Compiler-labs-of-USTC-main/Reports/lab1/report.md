# lab1实验报告
<p align=right>PB18000227 艾语晨</p>

## 实验要求
本次实验需要各位同学根据cminux-f的词法补全lexical_analyer.l文件，完成词法分析器，能够输出识别出的token，type，line(刚出现的行数)，pos_start(该行开始位置)，pos_end(结束的位置,不包含)。
## 实验难点
1. 关于flex的资料实属有限！如关于`yytext`、`yylex()`、`yyleng`的定义及使用在Google上也不容易找到简单易懂的参考文档
2. 对于正则表达式的书写，有部分符号需要转义，而字符（关键字匹配）是直接写该字符串或者用双引号引起来都可以，但是用单引号引起来是不行的
3. 关于辅助函数部分，每一个`case`下都需要一个`break;`，空格和注释不输出出来，但是他们依然需要占用行/列的位置，计数器还要正常计入
## 实验设计
本次实验为代码填空，分为模式匹配部分和辅助函数部分。模式匹配部分需要写出相应匹配项模式的正则定义，以及对应的操作（这里都是返回对应的返回值）。辅助函数部分需要定义`lines, pos_start, pos_end`，以及在不同`case`下对他们的操作（行内`pos`增加`yyleng`，换行`lines++`且`pos`重置。
## 实验结果验证
请提供部分自己的测试样例
增加了ID对`_`和数字的支持，并采用如下的测试文件：`2020fall-compiler_cminus/tests/lab1/testcase/self.cminus`
```c
int main(int argc, char const *argv[])
{
	int _a;
	char ___ok;
	return 0;
}
```
得到如下的分析结果：`2020fall-compiler_cminus/tests/lab1/token/self.tokens`
```
int	280	1	1	4
main	285	1	5	9
(	272	1	9	10
int	280	1	10	13
argc	285	1	14	18
,	271	1	18	19
char	285	1	20	24
const	285	1	25	30
*	261	1	31	32
argv	285	1	32	36
[]	288	1	36	38
)	273	1	38	39
{	276	2	1	2
int	280	3	2	5
_a	285	3	6	8
;	270	3	8	9
char	285	4	2	6
___ok	285	4	7	12
;	270	4	12	13
return	282	5	2	8
0	286	5	9	10
;	270	5	10	11
}	277	6	1	2
```
## 实验反馈
做实验一定要 看文档！看文档！看文档！以及 @dueToLife 提供的提示。flex的强大要远超我的预期，所以其实很多工作就直接丢给flex就好了（比如模式识别的状态转换）
